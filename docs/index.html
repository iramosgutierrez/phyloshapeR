<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plot phylogenies with custom shapes • phyloshapeR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Plot phylogenies with custom shapes">
<meta property="og:description" content="phyloshapeR plots phylogenies to custom shapes. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">phyloshapeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/iramosgutierrez/phyloshapeR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="phyloshaper">phyloshapeR<a class="anchor" aria-label="anchor" href="#phyloshaper"></a>
</h1></div>
<!-- badges: start -->

<p><img src="reference/figures/phyloshapeR.png" width="140px" align="right"></p>
<p><code>phyloshapeR</code> is a package to plot phylogenies in a custom shape</p>
<div class="section level2">
<h2 id="installing-labeler">Installing labeleR<a class="anchor" aria-label="anchor" href="#installing-labeler"></a>
</h2>
<p>To install <strong>phyloshapeR</strong> from GitHub, you might need to install the <em>devtools</em> package. Once you have it, you just have to specify the repository and install!</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"iramosgutierrez/phyloshapeR"</span><span class="op">)</span></span></code></pre></div>
<p>If you want to clone the repository, you can find the code <a href="https://github.com/iramosgutierrez/phyloshapeR" class="external-link">here</a>.</p>
</div>
<div class="section level2">
<h2 id="id_1-getting-started">1. Getting started<a class="anchor" aria-label="anchor" href="#id_1-getting-started"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"phyloshapeR"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="id_11-the-phyloshaper-package">1.1 The <code>phyloshapeR</code> package<a class="anchor" aria-label="anchor" href="#id_11-the-phyloshaper-package"></a>
</h3>
<p>The aim of this package is to create visual plots of phylogenies, but never to create phylogenetic trees to be used for analyses. The workflow of this package is to use an existing phylogenetic tree (or create a new one) and modify its branch lengths to match a particular shape. Originally it was designed to be used with administrative boundaries. It must be noted that depending on the contour of the desired shape, results may vary (more or less rounded shapes work better than long ones). However, several predefined shapes (as diamond, heart, star or polygons) have been added too.</p>
</div>
<div class="section level3">
<h3 id="id_12-preparing-the-data">1.2 Preparing the data<a class="anchor" aria-label="anchor" href="#id_12-preparing-the-data"></a>
</h3>
<p>The only files we need to use <code>pyloshapeR</code> are a shapefile (spatial vector) and a phylogenetic tree. However, both of them can be loaded or created internally.</p>
<div class="section level4">
<h4 id="loading-an-own-shapefile">Loading an own shapefile<a class="anchor" aria-label="anchor" href="#loading-an-own-shapefile"></a>
</h4>
<p>Shapefiles are spatial vectors that must be loaded using the <code>terra</code> package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/terra/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="st">"files/country_boundary.shp"</span><span class="op">)</span></span></code></pre></div>
<p>In case we lack a shapefile including the geometries we want to use, we can use a predefined map loaded in <code>phyloshapeR</code>. However, we must do some post-processing to select the corect geomentries, as unique countries have several polygons.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="fu">phyloshapeR</span><span class="fu">::</span><span class="va">world</span><span class="op">)</span></span>
<span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="va">shape</span><span class="op">[</span><span class="va">shape</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Australia"</span>,<span class="op">]</span> <span class="co">#We select all the territories from Australia's country</span></span>
<span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_territory.html">get_territory</a></span><span class="op">(</span><span class="va">shape</span>, order <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co">#we select the biggest one  (mainland Australia)</span></span></code></pre></div>
<p>In case you don’t want to shape your phylogeny using a country border, but want to use a predefined form, you can alternatively use function <code>getshape</code> (see below).</p>
</div>
<div class="section level4">
<h4 id="loading-an-own-phylogeny">Loading an own phylogeny<a class="anchor" aria-label="anchor" href="#loading-an-own-phylogeny"></a>
</h4>
<p>In case you want to use a specific tree to be plotted, it must be loaded using <code>ape's</code> package <code>read.tree</code> function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/" class="external-link">ape</a></span><span class="op">)</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span><span class="st">"example_tree.tre"</span><span class="op">)</span></span></code></pre></div>
<p>Keep in mind that this tree, if has too many tips may be pruned afterwords (i.e. some of the tips may be randomly eliminated). In case you want to use the complete tree, you will have to specify in the function afterwords to use the same tips for the shape as your tree has!</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="id_2-phyloshaper-functions">2. phyloshapeR functions<a class="anchor" aria-label="anchor" href="#id_2-phyloshaper-functions"></a>
</h2>
<div class="section level3">
<h3 id="getshape-function">getshape() function<a class="anchor" aria-label="anchor" href="#getshape-function"></a>
</h3>
<p>This function is needed only if you don’t have an own shapefile to be used and want to plot a phylogeny using some predefined forms. The options to be selected (i.e. the <code>type</code> argument) are diamond, star, heart, or a polygon of the desired number of sides (to be specified in the <code>sides</code> argument). Additionally, you can rotate the output shape using the <code>rotate</code> argument, specifying a number of degrees to rotate in a counter-clockwise direction.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">heart</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/getshape.html">getshape</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"heart"</span><span class="op">)</span></span>
<span><span class="va">hexagon</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/getshape.html">getshape</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"polygon"</span>, sides <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">square</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/getshape.html">getshape</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"polygon"</span>, sides <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">rot.square</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/getshape.html">getshape</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"polygon"</span>, sides <span class="op">=</span> <span class="fl">4</span>, rotate <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">heart</span>, main<span class="op">=</span><span class="st">"Heart"</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hexagon</span>, main<span class="op">=</span><span class="st">"Hexagon"</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">square</span>, main<span class="op">=</span><span class="st">"Square"</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rot.square</span>, main<span class="op">=</span><span class="st">"Rotated Square"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-createshapes-1.png" width="100%"></p>
<p>In case you alternatively want to use a country border to shape your phylogeny, you might use the world map included in phyloshapeR. However, as most have more than one geometry (due to islands or other administrative separations), we have to select which geometry we want to use. This can be done manually, selecting the geometry we want to use one by one, or selecting the one with the biggest expanse (which is generally in the one of interest) using the accessory function <code>get_territory</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">world</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="fu">phyloshapeR</span><span class="fu">::</span><span class="va">world</span><span class="op">)</span></span>
<span><span class="va">australia</span> <span class="op">&lt;-</span> <span class="va">world</span><span class="op">[</span><span class="va">world</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Australia"</span>,<span class="op">]</span> <span class="co">#We select all the territories from Australia's country</span></span>
<span><span class="va">mainland.aus</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_territory.html">get_territory</a></span><span class="op">(</span><span class="va">australia</span>, <span class="fl">1</span><span class="op">)</span> <span class="co">#we select the biggest one  (mainland Australia)</span></span>
<span><span class="va">tasmania</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_territory.html">get_territory</a></span><span class="op">(</span><span class="va">australia</span>, <span class="fl">2</span><span class="op">)</span> <span class="co">#we select the second biggest one  (Tasmania)</span></span>
<span></span>
<span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">australia</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mainland.aus</span>, col<span class="op">=</span><span class="st">"green"</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tasmania</span>, col<span class="op">=</span><span class="st">"blue"</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mainland Australia"</span>, <span class="st">"Tasmania"</span>, <span class="st">"Not Selected"</span><span class="op">)</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-shape%20australia-1.png" width="100%"> Keep in mind that depending on the selected shape the results may vary. Using very linear shapes (as the border of Chile, for example), or borders with bends and turns (as the case of Great Britain) may result in strange outputs.</p>
</div>
<div class="section level3">
<h3 id="phyloshape-function">phyloshape() function<a class="anchor" aria-label="anchor" href="#phyloshape-function"></a>
</h3>
<p>Once we have our shape loaded or created, and optionally the phylogenetic tree to use, we have to calculate distances of the branches to plot afterwards. In case the tree is not specified, a random phylogen will be created, using the number of tips specified in parameter <code>ntips</code>. If a tree is specified, and has more tips than the specified, some of them will be randomply pruned to match the specified argument value.</p>
<p>There are different approaches to the calculation of branch lengths, which are specified in parameter <code>method</code>. Method “extend” will use the internal branch length values, and extend the length just in the branches over the tips. Contrarily, method “fill” (default) will re-calculate internal branch lengths. To do so, it sets the splitting point within nodes at a depth specified in argument <code>depth</code>. Values near to 1 will result in very long internal branches, splitting nnear the tips, while values near to 0 ill split near the root.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">ext.tree</span>  <span class="op">&lt;-</span> <span class="fu"><a href="reference/phyloshape.html">phyloshape</a></span><span class="op">(</span><span class="va">mainland.aus</span>, <span class="va">exampletree</span>, ntips <span class="op">=</span><span class="fl">120</span>, method <span class="op">=</span> <span class="st">"extend"</span><span class="op">)</span></span>
<span><span class="va">fill.tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/phyloshape.html">phyloshape</a></span><span class="op">(</span><span class="va">mainland.aus</span>, <span class="va">exampletree</span>, ntips<span class="op">=</span><span class="fl">120</span>, method <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html" class="external-link">plot.phylo</a></span><span class="op">(</span><span class="va">ext.tree</span>,  type <span class="op">=</span> <span class="st">"f"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span>, edge.width <span class="op">=</span> <span class="fl">0.75</span>,main<span class="op">=</span><span class="st">"Extend Method"</span><span class="op">)</span></span>
<span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html" class="external-link">plot.phylo</a></span><span class="op">(</span><span class="va">fill.tree</span>, type <span class="op">=</span> <span class="st">"f"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span>, edge.width <span class="op">=</span> <span class="fl">0.75</span>,main<span class="op">=</span><span class="st">"Fill Method"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-methods-1.png" width="100%"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">depth.025.tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/phyloshape.html">phyloshape</a></span><span class="op">(</span><span class="va">mainland.aus</span>, <span class="va">exampletree</span>, ntips<span class="op">=</span><span class="fl">120</span>, depth.k <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="va">depth.099.tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/phyloshape.html">phyloshape</a></span><span class="op">(</span><span class="va">mainland.aus</span>, <span class="va">exampletree</span>, ntips<span class="op">=</span><span class="fl">120</span>, depth.k <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html" class="external-link">plot.phylo</a></span><span class="op">(</span><span class="va">depth.025.tree</span>,  type <span class="op">=</span> <span class="st">"f"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span>, edge.width <span class="op">=</span> <span class="fl">0.75</span>,main<span class="op">=</span><span class="st">"depth.k = 0.25"</span><span class="op">)</span></span>
<span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html" class="external-link">plot.phylo</a></span><span class="op">(</span><span class="va">depth.099.tree</span>, type <span class="op">=</span> <span class="st">"f"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span>, edge.width <span class="op">=</span> <span class="fl">0.75</span>, main<span class="op">=</span><span class="st">"depth.k = 0.99"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-depths-1.png" width="100%"></p>
<p>Ultimately, we can select the coordinates where we want to set the root of our tree, specifying a Spatial Vector point in the <code>point</code> argument, using the auxiliar <code><a href="reference/coords_to_point.html">coords_to_point()</a></code> function. It must be noted that the specified point must be included within the shape extent. The default value to use (if <code>point</code> is not specified) will be the centroid of the geometry.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">point1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/coords_to_point.html">coords_to_point</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">125</span>, y<span class="op">=</span> <span class="op">-</span><span class="fl">22</span><span class="op">)</span></span>
<span><span class="va">point2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/coords_to_point.html">coords_to_point</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">145</span>, y<span class="op">=</span> <span class="op">-</span><span class="fl">28</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">centroid.tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/phyloshape.html">phyloshape</a></span><span class="op">(</span><span class="va">mainland.aus</span>, <span class="va">exampletree</span>, ntips<span class="op">=</span><span class="fl">120</span><span class="op">)</span></span>
<span><span class="va">point1.tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/phyloshape.html">phyloshape</a></span><span class="op">(</span><span class="va">mainland.aus</span>, <span class="va">exampletree</span>, ntips<span class="op">=</span><span class="fl">120</span>,  point <span class="op">=</span> <span class="va">point1</span><span class="op">)</span></span>
<span><span class="va">point2.tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/phyloshape.html">phyloshape</a></span><span class="op">(</span><span class="va">mainland.aus</span>, <span class="va">exampletree</span>, ntips<span class="op">=</span><span class="fl">120</span>,  point <span class="op">=</span> <span class="va">point2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">10</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html" class="external-link">plot.phylo</a></span><span class="op">(</span><span class="va">point1.tree</span>,  type <span class="op">=</span> <span class="st">"f"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span>, edge.width <span class="op">=</span> <span class="fl">0.75</span>,   main<span class="op">=</span><span class="st">"Custom west point"</span><span class="op">)</span></span>
<span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html" class="external-link">plot.phylo</a></span><span class="op">(</span><span class="va">centroid.tree</span>, type <span class="op">=</span> <span class="st">"f"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span>, edge.width <span class="op">=</span> <span class="fl">0.75</span>, main<span class="op">=</span><span class="st">"Centroid"</span><span class="op">)</span></span>
<span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html" class="external-link">plot.phylo</a></span><span class="op">(</span><span class="va">point2.tree</span>,  type <span class="op">=</span> <span class="st">"f"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span>, edge.width <span class="op">=</span> <span class="fl">0.75</span>,   main<span class="op">=</span><span class="st">"Custom east point"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-points-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="phylomap-function">phylomap() function<a class="anchor" aria-label="anchor" href="#phylomap-function"></a>
</h3>
<p>The last function is a custom plot to be used with the results of phyloshape() function. However, it is only a simplification of some parameters of <code>ape's</code> <code><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html" class="external-link">plot.phylo()</a></code> possibilities, proposed here. In case you are familiar with phylogeny plotting, you may prefer to custmize the parameters to your preferred options.</p>
<p><code><a href="reference/phylomap.html">phylomap()</a></code> has a set of editable parameters (<code>offset</code>, <code>cex</code>, <code>pch</code>, <code>tip.label.col</code>) that will affect to the plotting of the tips as labels (namely the distance from the tree, the character size, the character used to plot them, and the colour). Additional parameters can be passed through plot.phylo() function, always with the nomenclature used therein (you can use <code><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html" class="external-link">?ape::plot.phylo</a></code> to see the possibilities!).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">10</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/phylomap.html">phylomap</a></span><span class="op">(</span><span class="va">centroid.tree</span>, main<span class="op">=</span><span class="st">"Default output"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/phylomap.html">phylomap</a></span><span class="op">(</span><span class="va">centroid.tree</span>, offset <span class="op">=</span> <span class="fl">100000</span>, cex <span class="op">=</span> <span class="fl">0.5</span>, pch<span class="op">=</span><span class="st">"o"</span>, tip.label.col <span class="op">=</span> <span class="st">"red"</span>, main <span class="op">=</span><span class="st">"Changing tip label options"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/phylomap.html">phylomap</a></span><span class="op">(</span><span class="va">centroid.tree</span>, edge.width<span class="op">=</span><span class="fl">2</span>, edge.color<span class="op">=</span><span class="st">"green"</span>, main <span class="op">=</span><span class="st">"Changing tree options"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plotting-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>To cite package <span class="st">'phyloshapeR'</span> <span class="cf">in</span> publications use<span class="sc">:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  Ramos<span class="sc">-</span>Gutierrez <span class="fu">I</span> (<span class="dv">2024</span>). _phyloshapeR<span class="sc">:</span> plot phylogenies as maps_.</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>https<span class="sc">:</span><span class="er">//</span>github.com<span class="sc">/</span>iramosgutierrez<span class="sc">/</span>phyloshapeR<span class="sc">&gt;</span>.</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>A BibTeX entry <span class="cf">for</span> LaTeX users is</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">@</span>Manual{,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    title <span class="ot">=</span> {phyloshapeR<span class="sc">:</span> plot phylogenies as maps},</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    author <span class="ot">=</span> {Ignacio Ramos<span class="sc">-</span>Gutierrez},</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    year <span class="ot">=</span> {<span class="dv">2024</span>},</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    url <span class="ot">=</span> {https<span class="sc">:</span><span class="er">//</span>github.com<span class="sc">/</span>iramosgutierrez<span class="sc">/</span>phyloshapeR},</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/iramosgutierrez/phyloshapeR/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/iramosgutierrez/phyloshapeR/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing phyloshapeR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ignacio Ramos-Gutiérrez <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-8675-0114" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/iramosgutierrez/phyloshapeR/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/iramosgutierrez/phyloshapeR/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg"></a></li>
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active - The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="http://hits.dwyl.com/iramosgutierrez/phyloshapeR" class="external-link"><img src="https://hits.dwyl.com/iramosgutierrez/phyloshapeR.svg?style=flat-square" alt="HitCount"></a></li>
<li><a href="http://hits.dwyl.com/iramosgutierrez/phyloshapeR" class="external-link"><img src="https://hits.dwyl.com/iramosgutierrez/phyloshapeR.svg?style=flat-square&amp;show=unique" alt="HitCount"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Ignacio Ramos-Gutiérrez.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
